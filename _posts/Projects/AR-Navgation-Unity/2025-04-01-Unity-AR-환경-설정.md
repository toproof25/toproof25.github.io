---
title: Unity AR 환경 설정
description: null
date: 2025-04-01
categories:
- Projects
- AR-Navgation-Unity
tags:
- 캡스톤VR
- Unity
- AR
- 환경설정
img: /assets/img/2025-04-01-Unity-AR-환경-설정/
---
## Unity 설치
1. [Unity Hub 다운로드](https://unity.com/kr/download)
2. Unity Hub에서 에디터 다운로드 (*6000.0.44f1 LTS 버전*)
   ![Unity Hub에서 에디터 다운로드]({{page.img}}Unity Hub에서 에디터 다운로드.webp)
3. *Android Build Support* 체크 후 설치
   ![Android Build Support 체크 후 설치]({{page.img}}Android Build Support 체크 후 설치.webp)
4. 프로젝트 *3D (Built-in Render Pipeline)* 로 생성
   - AR 관련 기능은 Built-in Render Pipeline 대상으로 설계되었음
   ![프로젝트 3D (Built-in Render Pipeline) 로 생성]({{page.img}}프로젝트 3D (Built-in Render Pipeline) 로 생성.webp)

## 안드로이드 빌드 플레이어 세팅
1. 상단 옵션에 *File* -> *Build Profiles*  들어가기
2. Android를 누른 후 Switch Platform 눌러서 플랫폼 변경
   ![Android를 누른 후 Switch Platform 눌러서 플랫폼 변경]({{page.img}}Android를 누른 후 Switch Platform 눌러서 플랫폼 변경.webp)
3. Player에 들어가서 다음 옵션을 설정
   - **Minimum API Level:** **Android 7.0 (API Level 24)** 이상
   - **Scripting Backend:** **IL2CPP** 설정
   - **Target Architectures:** **ARM64** 체크
   - **Graphics API:** **Vulkan** 제거
     - 안보이면 Auto Graphics API 체크를 해제하면 보임
       ![안보이면 Auto Graphics API 체크를 해제하면 보임]({{page.img}}안보이면 Auto Graphics API 체크를 해제하면 보임.webp)
1. 아래에 XR Plug-in Management 에서 Plug-in Provides에 Google ARCore을 체크
   ![XR Plug-in Management 에서 Plug-in Provides에 Google ARCore을 체크]({{page.img}}XR Plug-in Management 에서 Plug-in Provides에 Google ARCore을 체크.webp)

## AR Foundation 설치
1. Unity 상단 *Window* ->*Package Maneger*
2. *Unity Registry* 선택
3. *AR Foundation* 검색
4. AR Foundation 선택 후 *install*
   ![AR Foundation 설치]({{page.img}}AR Foundation 설치.webp)

## ARCore XR Plugin 설치
1. Unity 상단 *Window* ->*Package Maneger*
2. *Unity Registry* 선택
3. *ARCore XR Plugin* 검색
4. ARCore XR Plugin 선택 후 *install*
   ![ARCore XR Plugin 설치]({{page.img}}ARCore XR Plugin 설치.webp)

## XR Simulation 설정
1. Project Settings -> XR Plug-in Management
2. 아래 사진처럼 *XR Simulation* 활성화
   ![아래 사진처럼 XR Simulation 활성화]({{page.img}}아래 사진처럼 XR Simulation 활성화.webp)
3. Window -> AR Foundation -> XR Environmant
   ![Window - AR Foundation - XR Environmant]({{page.img}}Window - AR Foundation - XR Environmant.webp) 
4. 시뮬레이션 환경이 잘 되었는지 확인

## AR Test
1. 하이어라키에 *Main Camera* 제거
2. 하이어라키에서 우클릭 -> XR -> *AR session, XR Origin*을 추가
   ![하이어라키에서 우클릭 - XR - AR session, XR Origin을 추가]({{page.img}}하이어라키에서 우클릭 - XR - AR session, XR Origin을 추가.webp)
3. *XR Origin* 내부에 *Main Camera*가 존재하는 지 확인
4. XR Origin을 클릭 스 인스펙터 창에서 *AR Plane Manager* 컴포넌트를 추가
   ![AR Plane Manager 컴포넌트를 추가]({{page.img}}AR Plane Manager 컴포넌트를 추가.webp)
5. 위와 마찬가지로 *AR Raycast Manager* 컴포넌트를 추가
6. 테스트를 위한 큐브 오브젝트를 추가
   ![테스트를 위한 큐브 오브젝트를 추가]({{page.img}}테스트를 위한 큐브 오브젝트를 추가.webp)
   추가 이후 프리팹으로 만들기
   ![추가 이후 프리팹으로 만들기]({{page.img}}추가 이후 프리팹으로 만들기.webp)
7. 평면 감지 확인을 위한 Plane, 테스트 큐브 색 변경 등 프리팹 설정
8. *ARObjectSpawner* Script를 만든 후 아래의 코드를 작성
	```cpp
	using UnityEngine;
	using UnityEngine.XR.ARFoundation;
	using UnityEngine.XR.ARSubsystems;
	using System.Collections.Generic;
	
	[RequireComponent(typeof(ARRaycastManager))] // ARRaycastManager 자동 추가
	public class ARObjectSpawner : MonoBehaviour
	{
		[SerializeField] private GameObject spawnPrefab; // 배치할 프리팹 (인스펙터에서 할당)
		private ARRaycastManager arRaycastManager;
		private List<ARRaycastHit> hits = new List<ARRaycastHit>();
	
		void Awake()
		{
			// ARRaycastManager 컴포넌트 가져오기
			arRaycastManager = GetComponent<ARRaycastManager>();
			Debug.Log("ARRaycastManager가 초기화되었습니다."); // 디버그 로그: 초기화 완료
		}
	
		void Update()
		{
			// 터치 입력 감지 및 처리
			if (Input.touchCount > 0)
			{
				Touch touch = Input.GetTouch(0);
				Debug.Log($"터치 감지됨: 위치({touch.position.x}, {touch.position.y})"); // 디버그 로그: 터치 위치 출력
	
				// 터치 시작 시점에만 반응
				if (touch.phase == TouchPhase.Began)
				{
					Debug.Log("터치가 시작되었습니다."); // 디버그 로그: 터치 시작
	
					// AR 평면 위에서의 Raycast 수행
					if (arRaycastManager.Raycast(touch.position, hits, TrackableType.PlaneWithinPolygon))
					{
						Pose hitPose = hits[0].pose; // 첫 번째 감지된 평면의 위치 가져오기
						Debug.Log($"평면 감지됨: 위치({hitPose.position.x}, {hitPose.position.y}, {hitPose.position.z})"); // 디버그 로그: 평면 위치 출력
	
						// 프리팹 생성 (위치와 회전은 평면과 일치)
						Instantiate(spawnPrefab, hitPose.position, hitPose.rotation);
						Debug.Log("프리팹이 생성되었습니다."); // 디버그 로그: 프리팹 생성 완료
					}
					else
					{
						Debug.Log("평면 감지 실패."); // 디버그 로그: 평면 감지 실패
					}
				}
			}
		}
	}
	```
9.  XR Origin에 해당 컴포넌트를 추가한 후 프리팹 연결
   ![XR Origin에 해당 컴포넌트를 추가한 후 프리팹 연결]({{page.img}}XR Origin에 해당 컴포넌트를 추가한 후 프리팹 연결.webp)

## 최종 빌드 테스트
1. 빌드 프로필에서 씬을 추가 및 안드로이드 연결
   - Scene추가는 Open Scene List 누르고, Add Open Scenes를 눌러서 추가
   ![Scene추가는 Open Scene List 누르고, Add Open Scenes를 눌러서 추가]({{page.img}}Scene추가는 Open Scene List 누르고, Add Open Scenes를 눌러서 추가.webp)
1. Build and Run을 눌러 안드로이드로 빌드
2. 빌드 후 평면 인식과 터치 시 프리팹이 나타나는 지 테스트
   ![빌드 후 평면 인식과 터치 시 프리팹이 나타나는 지 테스트]({{page.img}}빌드 후 평면 인식과 터치 시 프리팹이 나타나는 지 테스트.webp)




---
## 링크 및 참고자료

##### 링크 문서
- [그래프를 이용하여 직접 경로 탐색]({% post_url 2025-08-25-그래프를-이용하여-직접-경로-탐색 %})
- [Unity AR 환경 설정]({% post_url 2025-04-01-Unity-AR-환경-설정 %})
- [해결방법 링크에러나는거 별명 이다]({% post_url 2025-04-01-Unity-AR-환경-설정 %}#해결-방법)
- [에러나는거 별명 이다]({% post_url 2025-04-01-Unity-AR-환경-설정 %})
- [과목 설명]({% post_url 2025-04-01-과목-설명 %})
- [Unity6 GPS 경도, 위도 받아오기]({% post_url 2025-04-15-Unity6-GPS-경도-위도-받아오기 %})
- [Google API 사용하기]({% post_url 2025-04-29-Google-API-사용하기 %})
- [Naver Maps API 사용하기]({% post_url 2025-04-29-Naver-Maps-API-사용하기 %})
- [Tmap API 사용하기]({% post_url 2025-04-29-Tmap-API-사용하기 %})
- [Mapbox SDK 사용하기]({% post_url 2025-04-30-Mapbox-SDK-사용하기 %})
- [Google AR Core API WGS84앵커 생성]({% post_url 2025-05-21-Google-AR-Core-API-WGS84앵커-생성 %})
- [WGS84 앵커에 고도값을 추가 (Google Elevation API)]({% post_url 2025-05-21-WGS84-앵커에-고도값을-추가-Google-Elevation-API %})

##### 참고자료(출처)
- 




